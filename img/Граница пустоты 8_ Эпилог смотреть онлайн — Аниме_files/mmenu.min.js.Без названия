define(["jquery"],function(e){"use strict";var t=function(s,i){this._element=s,this.$element=e(this._element),this.$element.data("mmenu")||this.$element.data("mmenu",this),this.options=e.extend({},t.Default,i),this._isOpen=!1,this._processing=!1,this._intervalId=null,this.$_blocker=e('<div id="mm-blocker" class="mm-slideout" />'),this.$_html=e("html"),this.$_page=e(this.options.page),this.$_menu=e(this.options.menu),this.$_menu.length||(this.$_menu=e('<nav id="'+this.options.menu.slice(1)+'" />'),e("body").prepend(this.$_menu)),this.$_header=this.$_menu.children(".mm-header"),this.$_header.length||(this.$_header=e('<div class="mm-header" />')),this.$_content=this.$_menu.children(".mm-content"),this.$_content.length||(this.$_content=e('<div class="mm-content" />')),this.$_footer=this.$_menu.children(".mm-footer"),this.$_footer.length||(this.$_footer=e('<div class="mm-footer" />')),this._class={html:{opening:"mm-opening",blocking:"mm-blocking mm-background",opened:"mm-opened"},page:"mm-slideout mm-page",menu:{init:"mm-menu mm-offcanvas mm-fx-menu-slide",opened:"mm-opened"},button:"active",widescreen:"mm-widescreen",panel:"mm-panels"},this._events={open:{start:"open.mmenu.start",finish:"open.mmenu.finish"},close:{start:"close.mmenu.start",finish:"close.mmenu.finish"}},this.init()};return t.Default={speed:390,page:"#wrap",menu:"#menu",theme:"mm-theme-white",widescreen:992,openEvent:"click touchstart",closeEvent:"click touchstart"},t.prototype={setContent:function(e){this.$_content.html(e)},reInitOpenEvent:function(){this.$element.off(this.options.openEvent),this.$element=e(this._element),this.initOpenEvent()},initOpenEvent:function(){this.$element.on(this.options.openEvent,function(e){e.preventDefault(),this.isOpen()?this.close():this.open()}.bind(this))},init:function(){this.$_menu.append(this.$_header),this.$_menu.append(this.$_content),this.$_menu.append(this.$_footer),this.$_page.addClass(this._class.page),this.$_menu.addClass(this._class.menu.init).addClass(this.options.theme),this.initOpenEvent()},open:function(){var t,s={relatedTarget:this};this.setProcessing(!0),window.clearTimeout(this._intervalId),this.$element.trigger(t=e.Event(this._events.open.start,s)),t.isDefaultPrevented()||(this.$_menu.data("header")&&!this.$_header.children().length&&this.$_header.html(JSON.parse(this.$_menu.data("header"))),this.$_menu.data("content")&&!this.$_content.children().length&&this.$_content.html(JSON.parse(this.$_menu.data("content"))),this.$_menu.data("footer")&&!this.$_footer.children().length&&this.$_footer.html(JSON.parse(this.$_menu.data("footer"))),this.eventOff(),this.pageHeight(),e(window).on("resize.mmenu.widescreen",this.wideScreen.bind(this)),this._intervalId=window.setTimeout(function(){this.setProcessing(!1),this.setOpen(!0),this.$element.trigger(e.Event(this._events.open.finish,s))}.bind(this),this.options.speed))},close:function(){var t,s={relatedTarget:this};this.setProcessing(!0),window.clearTimeout(this._intervalId),this.$element.trigger(t=e.Event(this._events.close.start,s)),t.isDefaultPrevented()||(this.eventOff(),e(document).off("touchmove.mmenu"),this._intervalId=window.setTimeout(function(){this.setProcessing(!1),this.setOpen(!1),this.$element.trigger(e.Event(this._events.close.finish,s))}.bind(this),this.options.speed))},eventOff:function(){e(window).off("resize.mmenu.widescreen"),this.$_blocker.off(this.options.closeEvent),e(window).off("resize.mmenu.pageheight")},wideScreen:function(){e(window).width()>=this.options.widescreen?(this.$_html.addClass(this._class.widescreen),this.$_menu.addClass(this._class.widescreen)):(this.$_html.removeClass(this._class.widescreen),this.$_menu.removeClass(this._class.widescreen))},setProcessing:function(t){this._processing=!0===t,this.isProcessing()&&!this.isOpen()?(this.$_html.addClass(this._class.html.opening).addClass(this._class.html.blocking),this.$_menu.addClass(this._class.menu.opened),e(this.options.page).after(this.$_blocker)):this.isProcessing()&&this.isOpen()&&(this.$_html.removeClass(this._class.html.opening),this.$_blocker.remove())},isProcessing:function(){return!0===this._processing},setOpen:function(t){this._isOpen=!0===t,this.isOpen()?(this.$_html.addClass(this._class.html.opened),this.$element.addClass(this._class.button),e(window).on("resize.mmenu.pageheight",this.pageHeight.bind(this)),this.$_blocker.one(this.options.closeEvent,function(e){e.preventDefault(),this.close()}.bind(this))):(this.$_html.removeClass(this._class.html.opened).removeClass(this._class.html.blocking),this.$_menu.removeClass(this._class.menu.opened),this.$element.removeClass(this._class.button),this.$_page.removeAttr("style"))},pageHeight:function(){this.$_page.css("min-height",e(window).height())},isOpen:function(){return!0===this._isOpen}},t});