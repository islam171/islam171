define(["jquery","requestAjax"],function(t,e){"use strict";var i=function(e,a){this.$element=e,this.options=t.extend({},i.Default,a),this.ratingUser=t(this.$element.querySelector(".rating-user")),this.ratingUser.length||(this.ratingUser=t('<div class="rating-user">                                <div class="rating-value text-center mr-3" />                                <div class="rating-subtext small">'+this.$element.querySelector(".choice-rate-star").getAttribute("data-my-rate-text")+"</div>                            </div>")),this.init()};i.Default={star:".rate_star",activeStar:"star_current",activeBlock:"rate__rated"},i.prototype={init:function(){var e={relatedTarget:this};t(this.$element).on("change",'select[name="rating"]',function(i){var a=i.target;this.$element.querySelector(".rate-this").style.display="none",t(this.$element).is(this.ratingUser)||t(this.$element.querySelector(".choice-rate-star .rate-this")).after(this.ratingUser),a.value>0?(this.ratingUser.find(".rating-value").text(a.value),t(this.$element.querySelector('[data-rating="'+a.value+'"]')).trigger("click")):(this.$element.querySelector(".rate-this").style.display="block",this.ratingUser.remove()),t(a).trigger(t.Event("rating.un.change",e))}.bind(this)),t(this.$element).on("click",this.options.star,function(i){var a=t(i.currentTarget);a.hasClass(this.options.activeStar)||(a.siblings().removeClass(this.options.activeStar),a.addClass(this.options.activeStar),this.$element.classList.add(this.options.activeBlock),a.trigger(t.Event("rating.un.active",e)))}.bind(this)),t(this.$element).on({mouseenter:function(i){"ontouchstart"in document.documentElement||(this.$element.querySelector(".rate-this").style.display="none",t(this.$element).is(this.ratingUser)||t(this.$element.querySelector(".choice-rate-star .rate-this")).after(this.ratingUser),this.ratingUser.find(".rating-value").text(t(i.target).data("rating")),t(i.target).trigger(t.Event("rating.un.mouseenter",e)))}.bind(this),mouseleave:function(i){if(!("ontouchstart"in document.documentElement)){var a=i.target,n=this.$element.querySelector(".choice-rate-star");t(a.parentNode).children("."+this.options.activeStar).length?this.ratingUser.find(".rating-value").text(t(a.parentNode).children("."+this.options.activeStar).data("rating")):(n.querySelector(".rate-this").style.display="block",this.ratingUser.remove()),t(i.target).trigger(t.Event("rating.un.mouseleave",e))}}.bind(this)},this.options.star)}},t("#itemRatingBlock").each(function(){t(this).data("rating")||t(this).data("rating",new i(this))}),t(document).on("requireajax.un.shown",function(){t("#itemRatingBlock").each(function(){t(this).data("rating")||t(this).data("rating",new i(this))})}).on("mouseenter",".choice-rate",function(){"ontouchstart"in document.documentElement||(this.querySelector('select[name="rating"]').style.display="none",this.classList.add("open"))}).on("mouseleave",".choice-rate",function(){"ontouchstart"in document.documentElement||this.classList.remove("open")}).on("rating.un.active",function(i){(i.target.hasAttribute("data-rating-ajax")&&"false"!==i.target.getAttribute("data-rating-ajax")||!i.target.hasAttribute("data-rating-ajax"))&&(new e).dataAjax(i.target),t(i.target).closest(".choice-rate").removeClass("open")})});